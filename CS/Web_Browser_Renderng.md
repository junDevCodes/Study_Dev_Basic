# 웹 브라우저 렌더링 과정

## 1. URL 파싱 (URL Parsing)

### 개념
- 사용자가 입력한 URL을 완전한 형태로 변환하는 과정
- 예: `naver.com` → `https://www.naver.com`

### HTTPS (HyperText Transfer Protocol Secure)
- **정의**: 웹 브라우저와 웹 서버 간의 통신을 암호화하여 안전하게 만드는 프로토콜
- **특징**: 
  - SSL/TLS 프로토콜을 사용하여 데이터 암호화
  - HTTP + 보안 계층 = HTTPS
- **구성 요소**:
  - `//`: 프로토콜 구분자 (실제로는 필수가 아님)
  - `www`: World Wide Web의 축약어

---

## 2. DNS 조회 (Domain Name System)

### 개념
도메인명을 IP 주소로 변환하는 과정

### 조회 순서

#### 2.1 캐시 조회 (우선순위 순)
1. **브라우저 캐시**: 웹 브라우저 내부 저장소
2. **OS 캐시**: 운영체제 수준의 DNS 캐시
3. **라우터 캐시**: 공유기/라우터의 DNS 캐시

#### 2.2 DNS 서버 조회 (계층적 구조)
1. **로컬 DNS 서버**
   - ISP(인터넷 서비스 제공자)에서 제공
   - 공개 DNS 서버 (예: 8.8.8.8, 1.1.1.1)

2. **루트 DNS 서버**
   - 전 세계 최상위 도메인(.)을 관리
   - 13개의 루트 서버 클러스터 존재

3. **TLD DNS 서버 (Top-Level Domain)**
   - 최상위 도메인(.com, .org, .kr 등) 관리
   - 루트 DNS 서버에서 위임받음

4. **네임서버 (Authoritative DNS)**
   - 특정 도메인을 직접 관리하는 서버
   - 실제 웹 서비스의 IP 주소 반환

---

## 3. TCP 연결 설정

### 기본 개념
- **TCP/UDP**: 전송 계층 프로토콜 (OSI 7계층 중 4계층)
- **패킷**: 네트워크로 전송되는 데이터 단위
- **헤더**: 패킷의 제어 정보
- **플래그**: 연결 상태를 나타내는 제어 비트
  - SYN: 연결 요청
  - ACK: 응답 확인
  - FIN: 연결 종료 요청

### 3.1 3-Way Handshake (TCP 연결 설정)

#### 1단계: SYN (Synchronize)
- **클라이언트 → 서버**
- **내용**: "연결하고 싶어요. 제 시퀀스 번호는 ISN(클)입니다."
- **패킷 구성**:
  - IP 헤더: 송신/수신 IP 주소
  - TCP 헤더: SYN 플래그 = 1, ISN(클라이언트 초기 시퀀스 번호)

#### 2단계: SYN-ACK (Synchronize-Acknowledge)
- **서버 → 클라이언트**
- **내용**: "연결 승인합니다. 제 시퀀스 번호는 ISN(서)이고, 다음엔 ISN+1(클)로 보내주세요."
- **패킷 구성**:
  - IP 헤더: 송신/수신 IP 주소
  - TCP 헤더: SYN 플래그 = 1, ACK 플래그 = 1, 서버 ISN, ACK 번호 = 클라이언트 ISN + 1

#### 3단계: ACK (Acknowledge)
- **클라이언트 → 서버**
- **내용**: "확인했습니다. ISN+1(클)로 보내고, 서버도 ISN+1(서)로 보내주세요."
- **패킷 구성**:
  - IP 헤더: 송신/수신 IP 주소
  - TCP 헤더: SYN 플래그 = 0, ACK 플래그 = 1, ACK 번호 = 서버 ISN + 1

### 3.2 4-Way Handshake (TCP 연결 종료)

#### 1단계: FIN
- **클라이언트 → 서버**
- **내용**: "더 이상 보낼 데이터가 없습니다. 연결을 종료하겠습니다."
- **패킷 구성**: FIN 플래그 = 1

#### 2단계: ACK
- **서버 → 클라이언트**
- **내용**: "종료 요청을 확인했습니다. 남은 데이터를 전송 후 종료하겠습니다."
- **패킷 구성**: ACK 플래그 = 1

#### 3단계: FIN
- **서버 → 클라이언트**
- **내용**: "모든 데이터 전송이 완료되었습니다. 연결을 종료합니다."
- **패킷 구성**: FIN 플래그 = 1

#### 4단계: ACK
- **클라이언트 → 서버**
- **내용**: "종료를 확인했습니다."
- **패킷 구성**: ACK 플래그 = 1

### 3.3 UDP vs TCP 비교

#### UDP (User Datagram Protocol)
- **특징**:
  - 비연결성: 연결 설정 과정 없음
  - 비신뢰성: 데이터 전달 보장 안함
  - 빠른 속도: 헤더가 간단함
- **패킷 구성**:
  - IP 헤더 (송수신 IP)
  - UDP 헤더 (송수신 포트)
  - 데이터

---

## 4. TLS/SSL 핸드셰이크

### 개념
- **TLS (Transport Layer Security)**: SSL을 기반으로 한 현대적 보안 프로토콜
- **목적**: 통신 암호화, 데이터 무결성, 서버 인증 보장

### 핸드셰이크 과정

#### 1단계: Client Hello
- **클라이언트 → 서버**
- **포함 내용**:
  - TLS 버전 (1.2, 1.3 등)
  - Client Random (32바이트 랜덤 값)
  - Cipher Suite 목록 (지원하는 암호화 알고리즘)
  - SNI (Server Name Indication) - 도메인명

#### 2단계: Server Hello
- **서버 → 클라이언트**
- **포함 내용**:
  - 선택된 TLS 버전
  - Server Random (32바이트 랜덤 값)
  - 선택된 Cipher Suite

#### 3단계: Certificate
- **서버 → 클라이언트**
- **SSL 인증서 (X.509) 전송**:
  - 서버의 공개키
  - 도메인 정보 (CN, SAN 필드)
  - CA 서명 (공인 인증기관의 디지털 서명)
  - 유효 기간

#### 4단계: Client Key Exchange ⭐
- **클라이언트 → 서버**
- **Pre-Master Secret**을 서버 공개키로 암호화하여 전송
- **세션 키 생성**: Client Random + Server Random + Pre-Master Secret

#### 5단계: Change Cipher Spec & Finished
- **클라이언트**:
  - Change Cipher Spec: "암호화 통신 시작 선언"
  - Finished: 암호화된 메시지로 핸드셰이크 검증

#### 6단계: Change Cipher Spec & Finished
- **서버**:
  - Change Cipher Spec: "암호화 통신 시작 확인"
  - Finished: 암호화된 메시지로 핸드셰이크 검증

---

## 5. HTTP 요청 전송

### 개념
- HTTP 메서드를 사용하여 서버에 요청 전송
- TLS 패킷 위에 올려져 암호화된 상태로 전송

### 주요 HTTP 메서드
- GET: 리소스 조회
- POST: 데이터 생성
- PUT: 데이터 수정
- DELETE: 데이터 삭제

---

## 6. 서버 처리

### 과정
1. 메인 서버에서 HTTP 요청 수신
2. 요청에 따른 비즈니스 로직 실행
3. 데이터베이스 조회/수정 (필요시)
4. 응답 데이터 준비

---

## 7. HTTP 응답 전송

### 응답 구성 요소
- **상태 코드**: 200(성공), 404(Not Found), 500(서버 오류) 등
- **헤더**: Content-Type, Set-Cookie, Cache-Control 등
- **본문**: HTML, JSON, 이미지 등의 실제 데이터

---

## 8. 브라우저 렌더링

### 렌더링 엔진 동작 과정
1. **HTML 파싱**: DOM(Document Object Model) 트리 생성
2. **CSS 파싱**: CSSOM(CSS Object Model) 트리 생성
3. **렌더 트리 구성**: DOM + CSSOM 결합
4. **레이아웃 계산**: 요소들의 위치와 크기 결정
5. **페인팅**: 실제 픽셀로 화면에 그리기

---

## 9. 추가 리소스 로딩

### 병렬 로딩
- CSS 파일
- JavaScript 파일
- 이미지, 폰트 등의 미디어 파일
- 각 리소스는 별도의 HTTP 요청으로 처리

---

## 10. JavaScript 실행

### 동적 기능 구현
- **DOM 조작**: 페이지 요소 동적 변경
- **이벤트 처리**: 사용자 상호작용 반응
- **AJAX/Fetch**: 서버와 비동기 통신
- **SPA 라우팅**: 페이지 전환 없는 화면 변경

---

## 요약

웹 브라우저 렌더링 과정은 URL 입력부터 완전한 웹페이지 표시까지 복잡한 네트워크 통신과 렌더링 과정을 거칩니다. 각 단계는 웹의 성능과 보안에 중요한 역할을 하며, 현대 웹 개발에서 이해해야 할 핵심 CS 지식입니다.